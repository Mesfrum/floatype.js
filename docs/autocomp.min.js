function _(j,P={}){const H={...Z,...P};let h,C=0,z=[],G,M;j.autocomplete="off",["input","keydown","blur","focus"].forEach((f)=>j.addEventListener(f,Q));function Q(f){if(f.type==="keydown"&&V(f))return;if(f.type==="blur"){setTimeout(I,100);return}if(f.target.value===""){I(),G=null;return}if(f.target.value===G)return;G=f.target.value,clearTimeout(M),M=setTimeout(W,H.debounce)}function V(f){if(!h)return!0;switch(f.keyCode){case 38:return N(-1,f);case 40:return N(1,f);case 13:O(C),I();return;case 27:I();return}}async function W(){if(!G)return;if(z=await H.onQuery(G),!z.length){I();return}if(!h)X();Y()}function X(){h=document.createElement("div"),Object.assign(h.style,{width:window.getComputedStyle(j).width,position:"absolute",left:`${j.offsetLeft}px`,top:`${j.offsetTop+j.offsetHeight}px`}),h.classList.add("autocomp"),j.parentNode.insertBefore(h,j.nextSibling)}function Y(){h.innerHTML="",z.forEach((f,J)=>{const w=document.createElement("div");if(w.classList.add("autocomp-item"),H.onRender?w.appendChild(H.onRender(f)):w.innerText=f,J===C)w.classList.add("autocomp-sel");w.addEventListener("click",()=>O(J)),h.appendChild(w)})}function N(f,J){J.preventDefault();const w=h.querySelector(`:nth-child(${C+1})`);w&&w.classList.remove("autocomp-sel"),C=(C+f+z.length)%z.length,h.querySelector(`:nth-child(${C+1})`).classList.add("autocomp-sel")}function O(f){if(!H.onSelect)return;G=H.onSelect(z[f]),j.value=G||z[f]}function I(){if(z=[],C=0,h)h.remove(),h=null}}var Z={onQuery:null,onNavigate:null,onSelect:null,onRender:null,debounce:100},g=_;export{g as default,_ as autocomp};
